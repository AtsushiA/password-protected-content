(()=>{async function t(t){const e=(new TextEncoder).encode(t),o=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(o)).map(t=>t.toString(16).padStart(2,"0")).join("")}function e(t){try{const e=atob(t),o=new Uint8Array(e.length);for(let t=0;t<e.length;t++)o[t]=e.charCodeAt(t);return new TextDecoder("utf-8").decode(o)}catch(t){throw console.error("Decode error:",t),new Error("Failed to decode content")}}document.addEventListener("DOMContentLoaded",async function(){const o=document.querySelectorAll(".wp-block-telex-password-protected-content");for(const n of o){const o=n.querySelector(".password-protected-content__form"),r=n.querySelector(".password-protected-content__input"),c=n.querySelector(".password-protected-content__button"),d=n.querySelector(".password-protected-content__error"),s=n.dataset.content,a=n.dataset.passwordHash;o&&s&&a&&o.addEventListener("submit",async function(o){o.preventDefault();const i=r.value.trim();if(i){c.disabled=!0,c.textContent="確認中...",d&&(d.style.display="none");try{if(await t(i)!==a)throw new Error("Invalid password");const o=e(s);n.innerHTML='<div class="password-protected-content__unlocked"><div class="password-protected-content__content">'+o+"</div></div>",n.classList.add("is-unlocked")}catch(t){d&&(d.textContent="パスワードが正しくありません。",d.style.display="block"),c.disabled=!1,c.textContent="確認",r.value="",r.focus()}}})}})})();